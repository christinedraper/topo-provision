require 'chef/provisioning/aws_driver'

#### THIS RECIPE IS AUTO-GENERATED BY TOPO-PROVISION - EDITS WILL BE OVERWRITTEN ####


with_driver('aws')
with_machine_options({})


load_balancer "elbappserverelb" do
  load_balancer_options({:availability_zones=>["us-west-2c", "us-west-2b", "us-west-2a"], :listeners=>[{:instance_port=>3001, :protocol=>"HTTP", :instance_protocol=>"HTTP", :port=>3001}]})
end


machine "instancedbserver" do
  add_machine_options({:bootstrap_options=>{:disable_api_termination=>false, :image_id=>"ami-f1ce8bc1", :instance_type=>"t1.micro", :kernel_id=>"aki-fc8f11cc", :key_name=>"test1_aws", :monitoring_enabled=>false, :associate_public_ip_address=>"true"}})
end


aws_launch_configuration "asgappservergroup_config" do
  image("ami-97ba9aa7")
  options({:instance_type=>"t1.micro", :instance_monitoring=>"true"})
end


aws_auto_scaling_group "asgappservergroup_group" do
  launch_configuration("asgappservergroup_config")
  availability_zones(["us-west-2c", "us-west-2b", "us-west-2a"])
  load_balancers(["elbappserverelb"])
  options({:cooldown=>300, :desired_capacity=>1, :max_size=>2, :min_size=>1, :health_check_grace_period=>0, :health_check_type=>:EC2})
end

